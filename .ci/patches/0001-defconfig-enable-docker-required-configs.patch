
From 111111111111111111111 Mon Sep 17 00:00:00 2001
Subject: [PATCH 1/3] vendor/sm8250_defconfig: enable Docker-required CONFIGs and embed kernel config

diff --git a/arch/arm64/configs/vendor/sm8250_defconfig b/arch/arm64/configs/vendor/sm8250_defconfig
index abcdef0..1234567 100644
--- a/arch/arm64/configs/vendor/sm8250_defconfig
+++ b/arch/arm64/configs/vendor/sm8250_defconfig
@@ -1,3 +1,70 @@
+# --- Embed kernel config for /proc/config.gz (required by check-config.sh) ---
+CONFIG_IKCONFIG=y
+CONFIG_IKCONFIG_PROC=y
+
+# --- Namespaces ---
+CONFIG_NAMESPACES=y
+CONFIG_UTS_NS=y
+CONFIG_IPC_NS=y
+CONFIG_PID_NS=y
+CONFIG_NET_NS=y
+CONFIG_USER_NS=y
+
+# --- cgroups (v1/v2) ---
+CONFIG_CGROUPS=y
+CONFIG_CGROUP_DEVICE=y
+CONFIG_CPUSETS=y
+CONFIG_CGROUP_CPUACCT=y
+CONFIG_BLK_CGROUP=y
+CONFIG_MEMCG=y
+CONFIG_CGROUP_PIDS=y
+CONFIG_CGROUP_FREEZER=y
+CONFIG_CGROUP_SCHED=y
+CONFIG_CGROUP_WRITEBACK=y
+
+# --- Filesystem (Docker overlay2 / overlayfs snapshotter) ---
+CONFIG_OVERLAY_FS=y
+
+# --- Container networking (veth/bridge/iptables/conntrack/NAT) ---
+CONFIG_VETH=y
+CONFIG_BRIDGE=y
+CONFIG_BRIDGE_NETFILTER=y
+CONFIG_NETFILTER=y
+CONFIG_NETFILTER_XTABLES=y
+CONFIG_NF_CONNTRACK=y
+CONFIG_NF_NAT=y
+CONFIG_IP_NF_IPTABLES=y
+CONFIG_IP_NF_FILTER=y
+CONFIG_IP_NF_MANGLE=y
+CONFIG_IP_NF_RAW=y
+CONFIG_IP_NF_SECURITY=y
+CONFIG_IP_NF_TARGET_MASQUERADE=y
+CONFIG_NETFILTER_XT_MATCH_ADDRTYPE=y
+CONFIG_NETFILTER_XT_MATCH_CONNTRACK=y
+CONFIG_NETFILTER_XT_MATCH_STATE=y
+CONFIG_NETFILTER_XT_MATCH_STATISTIC=y
+
+# --- Docker 28+ required (ipset and xt_set) ---
+CONFIG_IP_SET=m
+CONFIG_IP_SET_HASH_NET=m
+CONFIG_NETFILTER_XT_SET=m
+
+# *以上为容器运行的最小闭包；如需更强的安全隔离，可结合 SECCOMP/KEYS/SECURITY 等项。
+# *IKCONFIG/IKCONFIG_PROC 确保 /proc/config.gz 可用，便于 Moby 脚本离线校验。
+
 # 原有配置项...
