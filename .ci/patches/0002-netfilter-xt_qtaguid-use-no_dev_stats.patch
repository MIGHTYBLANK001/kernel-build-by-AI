
From 555555555555555555555 Mon Sep 17 00:00:00 2001
Subject: [PATCH] netfilter: xt_qtaguid: use no_dev_stats when iface inactive
---
 net/netfilter/xt_qtaguid.c | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

--- a/net/netfilter/xt_qtaguid.c
+++ b/net/netfilter/xt_qtaguid.c
@@ -737,7 +737,7 @@ static int proc_iface_stat_fmt(struct seq_file *m, void *v)
 {
     struct proc_iface_stat_fmt_info *p = m->private;
     struct iface_stat *iface_entry;
-    struct rtnl_link_stats64 dev_stats, *stats;
+    struct rtnl_link_stats64 *stats;
     struct rtnl_link_stats64 no_dev_stats = {0};
@@ -745,13 +745,8 @@ static int proc_iface_stat_fmt(struct seq_file *m, void *v)
     current->pid, current->tgid, from_kuid(&init_user_ns, current_fsuid()));
     iface_entry = list_entry(v, struct iface_stat, list);
+    stats = &no_dev_stats;
-    if (iface_entry->active) {
-        stats = dev_get_stats(iface_entry->net_dev,
-                              &dev_stats);
-    } else {
-        stats = &no_dev_stats;
-    }
     /*
      * If the meaning of the data changes, then update the fmtX
      * string.
